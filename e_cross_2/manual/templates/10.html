{% extends 'manual.html' %}

{% block manual_page %}

<table width="100%"><tr>
    <td align="left">&nbsp<a href="/manual/9/">Руководство администратора и разработчика (структура проекта)</a>&nbsp</td>
    <td align="right">&nbsp&nbsp</td>
</tr></table>

<h2 align="center">Руководство администратора и разработчика</h2>
<br>
<h3>Описание функций (Модуль "cross")</h3>
<br>

<b>Объекты:</b>
<br>
<ul>
<li><b>find_bu</b> - поиск шкафа по адресу - отображение содержимого найденного шкафа или отображение номеров всех строений на выбранной улице</li>
<li><b>find_agr</b> - поиск и отображение особых шкафов</li>
<!--<li><b>find_do</b> - поиск кроссировок и заявок по договору</li>-->
<li><b>find_dev</b> - поиск оборудования по 4-м параметрам (ip, mac, sn, vlan)</li>
<!--<li><b>new_bu</b> - добавление здания в базу</li>-->
<li><b>show_build</b> - отображение шкафов по адресу</li>
<li><b>show_locker</b> - отображение содержимого выбранного шкафа</li>
Для каждого оборудования в шкафу также подсчитывается количество и тип кроссировок
</ul>
<ul>
<li><b>new_locker</b> - создание нового шкафа</li>
<li><b>new_cr</b> - добавление нового кросса</li>
<li><b>new_dev</b> - добавление нового оборудования</li>
<li><b>add_v_port</b> - добавление виртуального порта к оборудованию</li>
<li><b>new_box</b> - добавление новой КРТ</li>
входящие данные: <b>bu_id</b> - Building_id, <b>lo_id</b> - Locker_id
<br>В соответствии с шаблоном, в базе создаются само оборудование и необходимое количество портов к нему
</ul>
<ul>
<li><b>show_cr</b> - отображение портов выбранного кросса</li>
<li><b>show_dev</b> - отображение портов выбранного оборудования</li>
<li><b>show_box</b> - отображение портов выбранной КРТ</li>
входящие данные: <b>bu_id</b> - Building_id, <b>lo_id</b> - Locker_id, <b>cr_id dev_id box_id</b> - id соответствующего оборудования
<br>В представлении создается словарь со списками всех портов и кроссировок (состояние порта, статус кроссировки, с чем скроссировано, др.дополнительная информация)
</ul>
<br>

<b>Кроссировки:</b>
<br>
<ul>
Все действия по изменению кроссировок в базе выполняются внутри транзакции. Перед транзакцией дополнительно проверяются допустимые параметры затрагиваемых изменениями ресурсов
<br>
<li><b>ext_cr1</b> - внешняя кроссировка (1 шаг) - выбор удаленного шкафа</li>
входящие данные: <b>s_port_id</b> - id исходного порта
<li><b>ext_cr2</b> - внешняя кроссировка (2 шаг) - отображение портов оборудования (и их состояния) в выбранном шкафу</li>
входящие данные: <b>s_port_id</b> - id исходного порта, <b>d_bu_id</b> - id удаленного шкафа
<li><b>cr_tr_matrix</b> - функция разворота матрицы - для правильного отображения портов кросса</li>
<li><b>ext_ok</b> - внешняя кроссировка (3 шаг) - выбор типа кроссировки и запись изменений в базу</li>
входящие данные: <b>s_port_id</b> - id исходного порта, <b>d_bu_id</b> - id удаленного шкафа, <b>d_port_id</b> - id порта назначения
<li><b>del_cr</b> - удаление внешней кроссировки</li>
входящие данные: <b>s_port_id</b> - id исходного порта
<br><br>
<li><b>int_c</b> - внутренняя кроссировка (1 шаг) - отображение портов оборудования (и их состояния) в текущем шкафу</li>
входящие данные: <b>s_port_id</b> - id исходного порта, <b>s_type</b> - тип исходного оборудования
<li><b>int_ok</b> - внутренняя кроссировка (2 шаг) - выбор типа кроссировки и запись изменений в базу</li>
входящие данные: <b>s_port_id</b> - id исходного порта, <b>s_type</b> - тип исходного оборудования, <b>d_port_id</b> - id порта назначения, <b>d_type</b> - тип конечного оборудования
<li><b>del_int_c</b> - удаление внутренней кроссировки</li>
входящие данные: <b>s_port_id</b> - id исходного порта, <b>s_type</b> - тип исходного оборудования
<br><br>
<li><b>cr_ab</b> - абонентская кроссировка - отображение формы ввода абонентских данных, отображение все портов активного оборудования в шкафу с их состояниями и кроссировками для возможности сменить порт, формирование строки примечания</li>
входящие данные: <b>box_id</b> - id КРТ, <b>port_id</b> - id порта КРТ
<br>основные ветвления: 
    <ul>
    <li>удачное кроссирование, запись изменений в базу</li>
    <li>выбор другого порта коммутатора (ch_port !='0') -> показать форму заново с учетом выбранного порта</li>
    </ul>
<li><b>del_ab</b> - удаление абонентской кроссировки с возможностью выбора причины</li>
входящие данные: <b>box_id</b> - id КРТ, <b>port_id</b> - id порта КРТ, <b>pri</b> - код причины
</ul>
<br>

<b>Редактирование объектов и кроссировок:</b>
<br>
<ul>
<li><b>edit_locker</b> - редактирование данных шкафа</li>
<li><b>edit_cr</b> - редактирование кросса</li>
<li><b>edit_cr_p</b> - редактирование порта кросса и типа кроссировок</li>
<li><b>info_dev</b> - вывод информации об оборудовании без возможности редактирования</li>
<li><b>edit_dev</b> - редактирование оборудования</li>
<li><b>edit_dev_p</b> - редактирование типа кроссировок на порту</li>
<li><b>edit_dev_p_v</b> - редактирование конфигурации порта</li>
<li><b>edit_box</b> - редактирование КРТ</li>
<li><b>edit_box_p</b> - редактирование порта КРТ и типа кроссировок</li>
входящие данные: <b>bu_id</b> - Building_id, <b>lo_id</b> - Locker_id, <b>cr_id dev_id box_id</b> - id соответствующего оборудования
<li><b>del_cross, del_dev, del_v_port, del_box</b> - удаление соответствующих объектов</li>
<li><b>to_his</b> - запись истории операций</li>
входящие данные: <b>data</b> - список кодов операций
</ul>
<br>
<br>


<h3>Описание функций (Модуль "kpp")</h3>
<br>
<ul>
<li><b>index</b> - отображение главной страницы</li>
<li><b>login, logout</b> - авторизация</li>
<li><b>new_kvar, new_str, new_bu</b> - добавление квартала, улицы, здания</li>
<li><b>service</b> - страница с сервисными функциями</li>
<li><b>show_all_logs</b> - показ журнала операций за текущий день</li>
<li><b>show_logs</b> - показ журнала операций для выбранного объекта или порта</li>
<li><b>trans_his</b> - формирование списка истории</li>
<li><b>js_request</b> - ответы на GET запросы от JS</li>
<li><b>from_dev</b> - прием конфигураций оборудования (в разработке)</li>
</ul>

<br><br>
<h3>Описание функций (Модуль "app_proc")</h3>
<br>
<ul>
<li><b>app, app_sort</b> - отображение списка заявок</li>
<li><b>app_find</b> - поиск кроссировок и заявок по номеру договора или ордера</li>
<li><b>from_bgb</b> - запрос в биллинг о конкретном договоре</li>
<li><b>add_app</b> - добавление заявки вручную</li>
<!--<li><b>new_app</b> - добавление заявки через POST запрос (в разработке)</li>-->
<li><b>edit</b> - редактирование заявки</li>
<li><b>app_install</b> - обработка заявки на установку, формирование списка портов КРТ по текущему адресу</li>
входящие данные: <b>app_id</b> - id заявки, <b>box_p_id</b> - id забронированного порта КРТ
<li><b>res_for_bil</b> - формирование строки ресурсов для инженера-инсталлятора</li>
<li><b>app_reject</b> - отказ заявки на установку</li>
<li><b>app_delay</b> - откладывание заявки</li>
<li><b>to_inbox</b> - перемещение заявки в "необработанные"</li>
<li><b>app_complete</b> - выполнение заявки на установку</li>
<li><b>app_check</b> - перемещение заявки "на сверку" и обратно</li>
<li><b>app_remove</b> - обработка заявки на снятие</li>
<li><b>app_reject2</b> - отказ заявки на снятие</li>
<li><b>app_complete2</b> - выполнение заявки на снятие</li>
<li><b>gen_pdf_0, gen_pdf_1, gen_pdf_2</b> - генерация PDF документа для инженера-инсталлятора</li>
</ul>

<br><br>

<h3>Описание функций (Модуль "cable")</h3>
<br>
<ul>
<li><b>cable_main</b> - отображение списка объектов при выборе квартала</li>
<li><b>create_obj_list</b> - формирование списка объектов</li>
<li><b>pw_add</b> - добавление нового объекта</li>
<li><b>coup_add</b> - добавление новой муфты</li>
<li><b>coup_view</b> - просмотр муфты</li>
<li><b>find_parrent</b> - определение родителя объекта</li>
<li><b>cab_up</b> - смена позиции кабеля в муфте</li>
<li><b>chain</b> - отображение цепочки кроссировок</li>
<li><b>cab_add1</b> - добавление кабеля (1 шаг) - выбор удаленной муфты</li>
<li><b>cab_add2</b> - добавление кабеля (2 шаг) - выбор типа кабеля и запись изменений в базу</li>
<li><b>int_c</b> - внутренняя кроссировка - отображение портов кросса и волокон (и их состояния) в текущей муфте</li>
<li><b>int_c_multi, int_c_multi_cross</b> - автоматическое кроссирование следующих по порядку волокон</li>
<li><b>int_del</b> - удаление внутренней кроссировки</li>
<li><b>int_edit</b> - редактирование состояния волокна</li>
<li><b>cab_edit</b> - редактирование состояния кабеля</li>
<li><b>cab_del</b> - удаление кабеля из муфт</li>
<li><b>cab_move1</b> - перемещение кабеля (1 шаг) - выбор удаленной муфты</li>
<li><b>cab_move2</b> - перемещение кабеля (2 шаг) - запись изменений в базу</li>
<li><b>pw_edit</b> - редактирование данных объекта</li>
<li><b>pw_del</b> - удаление объекта</li>
<li><b>coup_edit</b> - редактирование данных муфты</li>
<li><b>coup_del</b> - удаление муфты</li>
<li><b>map1</b> - отображение графической схемы</li>
<li><b>get_obj</b> - поиск и отображение ближайших объектов к выбранным координатам на схеме</li>
<li><b>to_his</b> - запись истории операций</li>
</ul>

<br><br>

<h3>Описание функций (Модуль "statist")</h3>
<br>
<ul>
<li><b>user_active</b> - выборка активных пользователей за определенное время</li>
<li><b>stat</b> - формирование общей статистики</li>
<li><b>stat2</b> - формирование статистики по ёмкости</li>
<li><b>stat_lo</b> - список узлов доступа, находящихся в проекте и монтаже</li>
<li><b>stat_lo_det</b> - список отдельностоящих зданий</li>
<li><b>stat_lo_noco</b> - список узлов доступа, не принадлежащих к офисам (УД-дубликаты, УД сторонних организаций, и др.)</li>
<li><b>stat_dev_type</b> - список оборудования определенного типа</li>
<li><b>stat_dev_br</b> - список забронированных портов на оборудовании</li>
<li><b>stat_dev_bad</b> - список неисправных портов на оборудовании</li>
<li><b>stat_box_br</b> - список забронированных портов на КРТ</li>
<li><b>stat_box_bad</b> - список неисправных портов на КРТ</li>
<li><b>stat_box_uninstall</b> - список портов на КРТ, помеченных на снятие</li>
<li><b>coup_changed</b> - список волокон, помеченных на изменение</li>
<li><b>cable_null_len</b> - список кабелей с нулевой длиной</li>
<li><b>dev_no_sn_mac</b> - список коммутаторов без ip, sn, mac</li>
<li><b>obj_no_coord</b> - список объектов без координат</li>
<li><b>duple_dog</b> - список повторяющихся договоров</li>
<li><b>bu_doc</b> - добавление и показ документов для выбранного узла доступа</li>
<li><b>bu_doc_del</b> - удаление документов для выбранного узла доступа</li>
<!--<li><b>res_for_bil</b> - формирование строки ресурсов для инсталлятора</li>-->
<li><b>sync_Coup_lo</b> - создание шкафных муфт, поиск шкафных муфт без шкафа</li>
<li><b>upl_dev</b> - парсинг CSV файлов (отключено, было нужно при переносе базы)</li>
<li><b>cl_dev</b> - очистка всех кроссировок для выбранного коммутатора (отключено)</li>
<li><b>check_link</b> - поиск неисправных кроссировок</li>
<li><b>check_dog</b> - сравнение договоров в базе с внешним списком</li>
<!--<li><b>ip_all_base</b> - проверка соответствия ip адресов в базе со внешним списком</li>-->
</ul>
<br>


<table width="100%"><tr>
    <td align="left">&nbsp<a href="/manual/9/">Руководство администратора и разработчика (структура проекта)</a>&nbsp</td>
    <td align="right">&nbsp&nbsp</td>
</tr></table>


{% endblock %}
