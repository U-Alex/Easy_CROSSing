{% extends 'main.html' %}

{% block cross %}

{% if dev_p_list %}
    <table border="0">
        <tr id="templ_header">
            <td width="1300px" align="left">
                <h3>
                    &nbsp&nbsp<a href="/cross/build={{ lo.parrent_id }}">{{ lo.parrent.name }} {{ lo.parrent.house_num }}</a>,
                    &nbsp&nbsp<a href="/cross/build={{ lo.parrent_id }}/locker={{ dev.parrent_id }}">УД: {{ lo.name }}</a>,
                    &nbsp&nbsp<label style="color:blue">{{ dev.name }}</label>
                    &nbsp&nbsp<a href="" style="color:blue">кроссировки</a> / 
                    <a href="/cross/build={{ lo.parrent_id }}/locker={{ dev.parrent_id }}/dev={{ dev.id }}/l2=1/">конфигурация</a> /
                    <a href="/cross/build={{ lo.parrent_id }}/locker={{ dev.parrent_id }}/dev={{ dev.id }}/ips/">коммутация</a>
                </h3>
            </td>
            <td width="300px" align="right">
                {% if kv.id != 1 %}
                квартал: {{ kv.name }}&nbsp&nbsp
                <a href="/statist/bu_doc={{ lo.parrent_id }}" target="_blank"><b>карточка ввода</b>&nbsp&nbsp</a>
                {% endif %}
            </td>
        </tr>
        <tr id="templ_header">
            <td colspan="2" align="left">&nbsp&nbsp
                {#доступные коммутаторы:&nbsp&nbsp#}
            {% for nav in dev_list %}
            {% if nav.id == dev.id %}
                <label style="color:blue"><strong>{{ nav.name }}</strong></label>&nbsp&nbsp
            {% else %}
                <a href="/cross/build={{ lo.parrent_id }}/locker={{ dev.parrent_id }}/dev={{ nav.id }}">{{ nav.name }}</a>&nbsp&nbsp
            {% endif %}
            {% endfor %}
            </td>
        </tr>
    </table>

    {% if bil_rq.0 %}
        {% include "bil_rq.html" %}
    {% else %}
    <br>
    {% endif %}
    
    <table width="1604px" border="1" id="templ_header">
    <!--<caption>&nbsp</caption>-->
        <tr>
            <td colspan="2" align="center">порт</td>
            <td colspan="6" align="center">кабельная связь</td>
            <td colspan="4" align="center">внешняя связь</td>
            <td rowspan="2" align="center" width="90px">алиас</td>
            <td rowspan="2" align="center">примечание</td>
            <td rowspan="2" align="center" width="30px">ред.</td>
            <td rowspan="2" align="center" width="20px">?</td>
        </tr>
        <tr id="templ_header">
            <td width="38px" align="center">№</td>
            <td width="38px" align="center">тип</td>
            <td width="38px" align="center">тип</td>
            <td width="140px" align="center">устр./КРТ</td>
            <td width="110px" align="center">порт/пл.(пары)</td>
            <td width="30px" align="center">+/X</td>
            <td width="80px" align="center">договор</td>
            <td width="50px" align="center">кв</td>
            <td width="230px" align="center">адрес / история пары</td>
            <td width="180px" align="center">УД</td>
            <td width="140px" align="center">кросс</td>
            <td width="40px" align="center">порт</td>
        </tr>
        {% for ob in dev_p_list %}
            {%if ob.p_valid == False %}
            <tr id="tr_hover" style="background-color:gray">
            {%  else  %}
            <tr id="tr_hover" style="background-color:white">
            {% endif %}
                <td align="center" {% if ob.id == sel %} style="background-color:#FF0099"{% endif %}>
                    <label title="id-{{ ob.id }}" {% if ob.id == sel %} style="color:white" {% endif %}>&nbsp{{ ob.num }}&nbsp</label>
                </td>
                <td align="center">
                    <div {% if ob.uplink %}style="background-color:cyan"{% endif %}>
                    {% if ob.port_t_x != 2 %}<img src="/static/images/laser2.png" alt=" " title="оптический порт" width="14" height="14">{% endif %}
                    {% if ob.port_t_x != 1 %}<img src="/static/images/rj45_1.png" alt=" " title="медный порт" width="12" height="12">{% endif %}
                    </div>
                </td>
                {% if ob.c_down.1 != 'link_err' %}
                    <td align="center">
                        <img src="/static/images/{{ ob.c_down.0 }}" alt=" " title="" height="12">
                    </td>
                    <td style="background-color:{{ ob.c_down.5 }}" align="center">
                        <a href="{{ ob.c_down.7 }}/?sel={{ ob.c_down.10 }}" target="_blank"><b>{{ ob.c_down.1 }}</b></a>
                    </td>
                    <td style="background-color:{{ ob.c_down.5 }}" align="center">
                        <a href="{{ ob.c_down.7 }}/?sel={{ ob.c_down.10 }}" target="_blank">
                        {% if ob.c_down.1|slice:":1" == "0" %}<b>напрямую</b></a>
                        {% else %}<b>{{ ob.c_down.2 }}</b></a>
                        {% endif %}
                    </td>
                    {% if ob.int_c_status != 0 %}
                        <td align="center"><a href="del={{ ob.id }}/s_type=2/"><img src="/static/images/icon_deletelink.gif" alt="X" title="удаление кроссировки" width="12" height="12"></a></td>
                    {% elif ob.p_valid == False %}
                        <td></td>
                    {% else %}
                        <td align="center"><a href="s_p={{ ob.id }}/s_type=2/"><img src="/static/images/icon_addlink.gif" alt="+" title="добавление кроссировки" width="12" height="12"></a></td>
                    {% endif %}
                    <td style="background-color:{{ ob.c_down.6 }}" align="center">
                    {% if ob.c_down.8 == 'billing' %}
                        <a href="?sel={{ ob.id }}&bil_rq={{ ob.c_down.3.0 }}" title="{{ ob.c_down.4 }}" style="color:black">{{ ob.c_down.3.0 }}</a>
                    {% else %}
                        <label title="{{ ob.c_down.4 }}">{{ ob.c_down.3.0 }}</label>
                    {% endif %}
                    </td>
                    <td style="background-color:{{ ob.c_down.6 }}" align="center">{{ ob.c_down.3.1 }}</td>
                    {% if ob.c_down.0 != 'rj45_2.png' %}
                        <td style="background-color:{{ ob.c_down.9 }}" align="center">{{ ob.c_down.8.parrent.parrent.parrent.name }}&nbsp{{ ob.c_down.8.parrent.parrent.parrent.house_num }}</td>
                    {% else %}
                        <td style="background-color:{{ ob.c_down.9 }}">&nbsp{{ ob.c_down.11 }}</td>
                    {% endif %}
                        <td style="background-color:{{ ob.c_down.9 }}" align="center">
                            <a href="/cross/build={{ ob.c_down.8.parrent.parrent.parrent_id }}/locker={{ ob.c_down.8.parrent.parrent_id }}" target="_blank"><b>{{ ob.c_down.8.parrent.parrent.name }}</b></a>
                        </td>
                        <td style="background-color:{{ ob.c_down.9 }}" align="center">
                            <a href="/cross/build={{ ob.c_down.8.parrent.parrent.parrent_id }}/locker={{ ob.c_down.8.parrent.parrent_id }}/cr={{ ob.c_down.8.parrent_id }}/?sel={{ ob.c_down.8.id }}" target="_blank"><b>{{ ob.c_down.8.parrent.name }}</b></a>
                        </td>
                        <td style="background-color:{{ ob.c_down.9 }}" align="center">
                            <a href="/cross/build={{ ob.c_down.8.parrent.parrent.parrent_id }}/locker={{ ob.c_down.8.parrent.parrent_id }}/cr={{ ob.c_down.8.parrent_id }}/?sel={{ ob.c_down.8.id }}" target="_blank"><b>{{ ob.c_down.8.num }}</b></a>
                        </td>
                {% else %}
                    <td style="background-color:{{ ob.c_down.2 }}" align="center">{{ ob.c_down.0 }}</td>
                    <td colspan="9" style="background-color:red; color:white" align="center"><b>link error!!!</b></td>
                {% endif %}
                <td>&nbsp{{ ob.p_alias }}&nbsp</td>
                <td><font size="1">&nbsp{{ ob.prim }}&nbsp</font></td>
                <td align="center">
                    <a href="p_edit={{ ob.id }}/"><img src="/static/images/edit.png" alt="ред." title="редактирование" width="16" height="16"></a>
                </td>
                <td style="background-color:#bbbbbb" align="center">
                    <a href="/core/logs/t=6/id={{ ob.id }}"><img src="/static/images/icon-unknown.gif" alt="?" title="история операций" width="10" height="10"></a>
                </td>
        </tr>
        {% endfor %}
    </table>

{% else %}
    <p>Not ports!!?? (_)*(_)</p>
{% endif %}
    <br>
    <table border="0" id="templ_footer">
        <tr>
            <td width="1400px">&nbsp
                {{ dev.obj_type.parrent.name }}: <b>{{ dev.obj_type.name }}</b>
            {% if dev.ip_addr != None %}, IP: <b>{{ dev.ip_addr }}</b>{% endif %}
            {% if dev.mac_addr != "" %}, MAC: <b>{{ dev.mac_addr }}</b>{% endif %}
            {% if dev.sn != "" %}, SN: <b>{{ dev.sn }}</b>{% endif %}
            {% if dev.vers_po != "" %}, версия ПО: <b>{{ dev.vers_po }}</b>{% endif %}
            {% if dev.man_conf != "" %}, прошил: <b>{{ dev.man_conf }}</b>{% endif %}
            {% if dev.man_install != "" %}, монтаж: <b>{{ dev.man_install }}</b>{% endif %}
            {% if dev.date_ent|date:"d.m.Y" != "" %}, дата ввода: <b>{{ dev.date_ent|date:"d.m.Y" }}</b>{% endif %}
            {% if dev.date_repl|date:"d.m.Y" != "" %}, дата замены: <b>{{ dev.date_repl|date:"d.m.Y" }}</b>{% endif %}
            {% if temp %} {# отключено #}
                <input type="button" value="upload" onClick='location.href="/statist/build={{ lo.parrent_id }}/locker={{ dev.parrent_id }}/dev={{ dev.id }}/upl_dev/"'>&nbsp
                <input type="button" value="clear" onClick='location.href="/statist/build={{ lo.parrent_id }}/locker={{ dev.parrent_id }}/dev={{ dev.id }}/cl_dev/"'>
            {% endif %}
            </td>
            <td width="200px" align="right">
                <input type="button" value="абоненты" onClick='window.open("/statist/agr_to_abon={{ dev.id }}")'>&nbsp
                <input type="button" value="история" onClick='location.href="/core/logs/t=3/id={{ dev.id }}"'>&nbsp
                <input type="button" value="назад" onClick='location.href="/cross/build={{ lo.parrent_id }}/locker={{ dev.parrent_id }}"'>&nbsp
            </td>
        </tr>
    </table>


{% endblock %}

